<!doctype html><html>
<head>
  <title>TicTacToe</title>
  <style>
    body {
      background:#000;
      overflow:hidden;
      margin:0;
    }
  </style>
</head>
<body>
  <canvas></canvas>
<script>
// Define Variables;
let z=[0,0,0,0,0,0,0,0,0],kr=1,ye=0,Ya=0,Ys=0;

function yr(){c1.clearRect(yd,Yo-Yi,yf,gc*30);c1.fillText('SCORE  '+Ya+' - '+Ys,yd,Yo)}function yi(x,y){c1.beginPath();c1.arc(x,y,ya,0,Math.PI*2);c1.closePath();c1.stroke()}function yo(x,y){c1.beginPath();c1.moveTo(x-ys,y-ys);c1.lineTo(x+ys,y+ys);c1.moveTo(x-ys,y+ys);c1.lineTo(x+ys,y-ys);c1.stroke()}
p=document.querySelector('canvas'),c1=p.getContext("2d");rh=window.devicePixelRatio;gc=window.innerWidth*rh/1500;function f0(){p.style.width=window.innerWidth+"px";p.style.height=window.innerHeight+"px";p.width=window.innerWidth*rh;p.height=window.innerHeight*rh;c1.clearRect(0,0,p.width,p.height);yy()};f0();window.onresize=f0;
function yt(){c1.clearRect(yl,Yo-Yi,yf,gc*30);if(ye){ye=0;c1.fillText('PLAYER',yl+gc*105,Yo)}else{ye=1;c1.fillText('COMPUTER',yl+gc*60,Yo)}}function yy(){ya=gc*55,ys=gc*50,yd=gc*420,yk=gc*120,yf=gc*200,yg=gc*400,yh=gc*600,yj=gc*6,Yo=yk-gc*50,yl=yg+yd,yz=yh+yd,yx=yg+yk,yc=yh+yk,yv=gc*100,yb=yv+yd,yn=gc*303,ym=yn+yd,Yq=gc*506,Yw=Yq+yd,Ye=yv+yk,Yr=yn+yk,Yt=Yq+yk,Yy=yf+yd,Yu=yf+yk;Yi=gc*24;c1.fillStyle=c1.strokeStyle='#fff';c1.lineWidth=gc*17;c1.lineCap='round';c1.font=Yi+'px arial';res();yr();c1.fillText('RESTART',yd+gc*244,Yo);yt()}
function yu(){c1.clearRect(yd,yk,yh,yh);c1.fillRect(yd,Yu,yh,yj);c1.fillRect(yd,yx,yh,yj);c1.fillRect(Yy,yk,yj,yh);c1.fillRect(yl,yk,yj,yh)}

let n=yz-yl,q,c;

// Reset Game;
function res()
{
  Yp=Yf=0;yu();kr=1;z=[0,0,0,0,0,0,0,0,0];Yf=0;
};

// Process Win;
function yp()
{
  if(kr==2)
  {
    Ya+=1;yr();
  }
  else
  {
    Ys+=1;yr();
  };
};

// Detect Win;
function win(i,p)
{
  switch(i)
  {
    case 0:
    {
      if(z[1]==p&&z[2]==p||z[3]==p&&z[6]==p||z[4]==p&&z[8]==p)
      {
        return 1;
      };
      break;
    }
    case 1:
    {
      if(z[0]==p&&z[2]==p||z[4]==p&&z[7]==p)
      {
        return 1;
      };
      break;
    }
    case 2:
    {
      if(z[0]==p&&z[1]==p||z[5]==p&&z[8]==p||z[4]==p&&z[6]==p)
      {
        return 1;
      };
      break;
    }
    case 3:
    {
      if(z[4]==p&&z[7]==p||z[0]==p&&z[6]==p)
      {
        return 1;
      };
      break;
    }
    case 4:
    {
      if(z[3]==p&&z[5]==p||z[1]==p&&z[7]==p||z[2]==p&&z[6]==p||z[0]==p&&z[8]==p)
      {
        return 1;
      };
      break;
    }
    case 5:
    {
      if(z[2]==p&&z[8]==p||z[3]==p&&z[4]==p)
      {
        return 1;
      };
      break;
    }
    case 6:
    {
      if(z[2]==p&&z[4]==p||z[0]==p&&z[3]==p||z[7]==p&&z[8]==p)
      {
        return 1;
      };
      break;
    }
    case 7:
    {
      if(z[1]==p&&z[4]==p||z[6]==p&&z[8]==p)
      {
        return 1;
      };
      break;
    }
    case 8:
    {
      if(z[6]==p&&z[7]==p||z[2]==p&&z[5]==p||z[0]==p&&z[4]==p)
      {
        return 1;
      };
      break;
    }
  };

  return 0;
};

// Get Drawing Position;
function gdw(v,k)
{
  if(v==2){q=Yw;}else if(v){q=ym;}else{q=yb;};
  if(k==2){c=Yt;}else if(k){c=Yr;}else{c=Ye;};

  // Draw Move;
  if(kr==2)
  {
    yo(q,c);kr=1;
  }
  else
  {
    yi(q,c);kr=2;
  };
};

// Handle Computer Player;
function dtc()
{
  // Check Situation;
  let i=0;

  if(Yf>2)
  {
    while(i<9)
    {
      if(z[i]==0)
      {
        // Detect Win;
        if(win(i,2))
        {
          // Set And Draw;
          z[i]=kr;Yf=9;yp();gdw(i%3,i/3|0);

          return;
        };
      };

      i+=1;
    };

    i=0;

    while(i<9)
    {
      if(z[i]==0)
      {
        // Prevent Possible Loss;
        if(win(i,1))
        {
          // Set And Draw;
          z[i]=kr;Yf+=1;gdw(i%3,i/3|0);

          return;
        };
      };

      i+=1;
    }
  };

  // Random Position;
  let j=0,t=(Math.random()*(9-Yf))|0;
  
  i=0;

  while(i<9)
  {
    if(z[i]==0)
    {
      if(j==t)
      {
        // Set And Draw;
        z[i]=kr;Yf+=1;gdw(i%3,i/3|0);

        break;
      };

      j+=1;
    };
    
    i+=1;
  };
};

p.onclick=function(e)
{
  x=e.x*rh;y=e.y*rh;if(x>yd)
  {
    if(yk>y)
    {
      // Button Click (Score, Restart, Player);
      if(x<Yy){Ya=Ys=0;yr()}else if(x<yl){res()}else{yt()}
    }
    else if(Yf!=9)
    {
      // Calculate Box Index;
      let v=(x-yd)/n|0,k=(y-yk)/n|0,b=k*3+v;

      if(z[b]==0)
      {
        z[b]=kr;

        // Check For Win;
        if(win(b,kr))
        {
          yp();Yf=9;gdw(v,k);
        }
        else
        {
          gdw(v,k);Yf+=1;

          // Computer Player;
          if(ye&&Yf!=9)
          {
            dtc();
          };
        };
      };
    }
    else
    {
      // Reset;
      console.log("Reset!");
      res();
    };
  };
};
</script>
</body>
</html>
